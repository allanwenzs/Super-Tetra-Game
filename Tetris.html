<!doctype html>
<html lang="en">
<head>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0b1020">

  <meta charset="utf-8"/>
  
  <meta name="author" content="Allan Wenzslaus">
  <meta name="publisher" content="Super Tetra Game">
  <meta name="contact" content="info@supertetragame.com">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>Super Tetra Game</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="app">
    <div class="card boardWrap">
      <div class="toast" id="toast"><span class="dot"></span><span id="toastText">Paused</span></div>

      <canvas id="game" width="360" height="720" aria-label="Tetris board"></canvas>

      <div class="overlay" id="overlayGameOver">
        <div class="modal">
          <div class="big" id="finalScore">0</div>
          <div class="miniStats">
            <span>High: <b id="finalHigh">0</b></span>
            <span>Level: <b id="finalLevel">1</b></span>
            <span>Lines: <b id="finalLines">0</b></span>
          </div>
          <p style="text-align:center;margin:6px 0 10px;color:rgba(233,238,255,.85)">
            Game Over â€” Press <b>Enter</b> to restart.
          </p>

          <div class="leader">
            <h4>Top 10 Leaderboard</h4>
            <ol id="leaderList"></ol>
          </div>

          <div style="display:flex;justify-content:center;gap:10px;margin-top:12px;flex-wrap:wrap">
            <button class="btn" id="restartBtn">Restart</button>
            <button class="btn" id="replayBtn2">Watch replay</button>
            <button class="toggle" id="clearLeaderboardBtn">Clear leaderboard</button>
          </div>
        </div>
      </div>
    </div>

    <div class="card side">
      <div class="hud">
        <div class="titleRow">
          <div class="logo">
            <div class="badge" aria-hidden="true">
              <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
                <path d="M4 6h6v6H4V6Zm10 0h6v6h-6V6ZM4 16h6v6H4v-6Zm10 4h6v2h-6v-2Zm0-4h2v2h-2v-2Zm4 0h2v2h-2v-2Z"
                      stroke="rgba(255,255,255,.85)" stroke-width="1.5" stroke-linejoin="round"/>
              </svg>
            </div>
            <div>
              <h1>Super Tetra Game <span class="buildTag">v2.1</span></h1>
              <div class="sub">Trainer hints â€¢ target outline â€¢ replay â€¢ analytics â€¢ keybinds â€¢ controller</div>
            </div>
          </div>
          <div class="pill"><span>â¸</span><b id="pauseLabel">Running</b></div>
        </div>

        
<div class="controlRow">
  <button class="btn" id="startBtn">Start Game</button>
  <button class="btn" id="pauseBtn">Pause</button>
  <button class="btn" id="restartBtnMain">Restart</button>
  <button class="btn" id="endBtn">End Game</button>
  <a class="btn" id="exitAppBtn" href="#exitModal">Exit</a>
</div>
<div class="compactStats">
<div class="stat"><div class="k">Score <span>âœ¨</span></div><div class="v" id="score">0</div></div>
<div class="stat"><div class="k">High <span>ğŸ†</span></div><div class="v" id="high">0</div></div>
<div class="stat"><div class="k">Level <span>âš¡</span></div><div class="v" id="level">1</div></div>
<div class="stat"><div class="k">Lines <span>ğŸ§¹</span></div><div class="v" id="lines">0</div></div>
</div>
<details class="menu" id="statsMenu">
  <summary>ğŸ“Š Stats <span style="opacity:.75">PPS â€¢ APM â€¢ trainer â€¢ finesse</span></summary>
  <div class="menuContent">
    <div class="stats">
<div class="stat"><div class="k">PPS <span>ğŸ“ˆ</span></div><div class="v" id="pps">0.00</div></div>
          <div class="stat"><div class="k">APM <span>âŒ¨ï¸</span></div><div class="v" id="apm">0</div></div>

          <div class="stat full">
            <div class="k">Trainer Step <span>ğŸ§©</span></div>
            <div class="v" id="stepInfo">â€”</div>
            <div class="subv">
              <span>Misses: <b id="stepMisses">0</b></span>
              <span>Mode: <b id="stepMode">Assist</b></span>
            </div>
          </div>

          <div class="stat full">
            <div class="k">Last Clear <span>ğŸ“£</span></div>
            <div class="v" id="lastClear">â€”</div>
          </div>

          <div class="stat full">
            <div class="k">Finesse (true path) <span>ğŸ§ </span></div>
            <div class="v" id="finEff">100%</div>
            <div class="subv">
              <span>Pieces: <b id="finPieces">0</b></span>
              <span>Errors: <b id="finErrors">0</b></span>
              <span>Last: <b id="finLast">â€”</b></span>
            </div>
          </div>

          <div class="stat full">
            <div class="k">Inputs (histogram) <span>ğŸ“Š</span></div>
            <div class="subv" id="hist">â€”</div>
          </div>

          <div class="stat full">
            <div class="k">Finesse by piece <span>ğŸ§©</span></div>
            <div class="subv" id="finByPiece">â€”</div>
          </div>
    </div>
  </div>
</details>

<details class="menu" id="settingsMenu">
  <summary>âš™ï¸ Settings <span style="opacity:.75">sound â€¢ display â€¢ trainer</span></summary>
  <div class="menuContent">
    <div class="panel">
          <h3>
            Previews & Trainer
            <div class="row">
              <button class="toggle" id="trainerToggle">ğŸ¯ Trainer: Off</button>
              <button class="toggle on" id="hintToggle">ğŸ’¡ Hints: On</button>
              <button class="toggle on" id="outlineToggle">ğŸŸ¦ Target outline: On</button>
              <button class="toggle" id="strictToggle">âš  Strict: Off</button>
              <button class="toggle on" id="soundToggle">ğŸ”Š Sound: On</button>
              <button class="toggle on" id="musicToggle">ğŸµ Music: On</button>
            </div>
          </h3>

          <div class="miniRow">
            <div class="miniBox">
              <div class="miniLabel"><span>Hold</span><span style="opacity:.8">C / 2-finger tap / Pad X</span></div>
              <canvas class="miniCanvas" id="holdCanvas" width="170" height="130"></canvas>
            </div>
            <div class="miniBox">
              <div class="miniLabel"><span>Next (8)</span><span style="opacity:.8">Trainer forces steps</span></div>
              <canvas class="miniCanvas" id="nextCanvas" width="170" height="320"></canvas>
            </div>
          </div>

          <div style="margin-top:12px">
            <div class="miniLabel" style="padding:0 2px">
              <span>Target Preview</span>
              <span style="opacity:.8">guide</span>
            </div>
            <canvas class="miniCanvas" id="targetCanvas" width="360" height="170"></canvas>
          </div>

          <div class="row" style="margin-top:10px">
            <select id="presetSelect" title="Opener preset">
              <option value="none">No preset</option>
              <option value="dt">DT Cannon (trainer)</option>
              <option value="tki">TKI (trainer)</option>
              <option value="pc">Perfect Clear (trainer)</option>
            </select>
            <button class="toggle" id="loadPresetBtn">Load</button>
            <button class="toggle" id="resetPresetBtn">Reset</button>
          </div>

          <div class="help" style="margin-top:10px">
            <div><kbd>â†</kbd>/<kbd>â†’</kbd> move â€¢ <kbd>â†“</kbd> soft drop â€¢ <kbd>â†‘</kbd> rotate</div>
            <div><kbd>Z</kbd> rotate CCW â€¢ <kbd>Shift</kbd> hard drop â€¢ <kbd>C</kbd> hold</div>
            <div><kbd>Space</kbd> pause â€¢ <kbd>Enter</kbd> restart (after game over)</div>
            <div style="margin-top:6px;opacity:.92">Touch: swipe L/R, swipe down, swipe up = hard drop, tap = rotate, 2-finger tap = hold</div>
          </div>
        </div>

        <div class="panel">
          <h3>Settings</h3>
          <div class="settingsGrid">
            <div class="setting">
              <div class="k">DAS <b id="dasVal">140</b></div>
              <input id="dasSlider" type="range" min="60" max="240" step="5" value="140"/>
              <div class="help" style="margin-top:6px">Delay before auto-repeat.</div>
            </div>
            <div class="setting">
              <div class="k">ARR <b id="arrVal">35</b></div>
              <input id="arrSlider" type="range" min="0" max="80" step="5" value="35"/>
              <div class="help" style="margin-top:6px">Repeat rate (0 = instant).</div>
            </div>
            <div class="setting">
              <div class="k">Gravity</div>
              <select id="gravitySelect" style="width:100%">
                <option value="modern" selected>Modern</option>
                <option value="classic">Classic</option>
                <option value="zen">Zen</option>
              </select>
              <div class="help" style="margin-top:6px">Speed curve style.</div>
            </div>

            <div class="setting">
              <div class="k">Music Volume <b id="musicVolVal">60</b></div>
              <input id="musicVolSlider" type="range" min="0" max="100" step="1" value="60"/>
              <div class="help" style="margin-top:6px">Background music level (independent from SFX).</div>
            </div>
            <div class="setting">
              <div class="k">Visual</div>
              <div class="row">
                <button class="toggle on" id="ghostToggle">ğŸ‘» Ghost: On</button>
                <button class="toggle on" id="fxToggle">âœ¨ FX: On</button>
                <button class="toggle on" id="shakeToggle">ğŸ«¨ Shake: On</button>
              </div>
              <div class="help" style="margin-top:6px">Toggle polish features.</div>
            </div>
          </div>
        </div>

        <div class="panel">
          <h3>
            Keybinds & Controller
            <div class="row">
              <button class="toggle" id="resetBindsBtn">Reset binds</button>
            </div>
          </h3>
          <div class="bindGrid" id="bindGrid"></div>
          <div class="help" style="margin-top:10px">
            Click a key to rebind. Press <kbd>Esc</kbd> to cancel. Controller: D-pad + A rotate, B CCW, Y hard drop, X hold, Start pause.
          </div>
        </div>

        
  </div>
</details>

<details class="menu" id="helpMenu">
  <summary>â“ Help <span style="opacity:.75">controls â€¢ touch â€¢ tips</span></summary>
  <div class="menuContent">
    <div class="help">Use arrow keys to move/rotate. Space pauses. Swipe controls on mobile.</div>

    <div class="panel" style="margin-top:10px">
      <h3>About</h3>
      <div class="help" style="color:rgba(233,238,255,.86)">
        <div><b>Super Tetra Game (STG)</b></div>
        <div>Developer/Publisher: <b>Super Tetra Game</b></div>
        <div>Contact: <a href="mailto:info@supertetragame.com" style="color:rgba(180,190,255,.95);text-decoration:none;border-bottom:1px dashed rgba(180,190,255,.45)">info@supertetragame.com</a></div>
        <div style="margin-top:8px;opacity:.9">Â© 2026 Super Tetra Game. All rights reserved.</div>
      </div>
    </div>

  </div>
</details>
<div class="footerRow">
          
          <span class="ownerLine">Â© 2026 Super Tetra Game â€¢ <a href="mailto:info@supertetragame.com">info@supertetragame.com</a></span>
<span id="padStatus">ğŸ® Gamepad: Not connected</span>
          <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap"><button class="btn" id="replayBtn" disabled>Replay</button></div>
        </div>
      </div>
    </div>
  </div>


  <!-- Exit helper modal (PWAs cannot reliably close themselves) -->
  <div class="exitBackdrop" id="exitModal" aria-hidden="true">
    <div class="exitCard" role="dialog" aria-modal="true" aria-labelledby="exitTitle">
      <h2 id="exitTitle">Exit Super Tetra Game</h2>
      <p>
        This is a web/PWA app, so it canâ€™t always close itself automatically for security reasons.
        Use one of the options below to close it.
      </p>
      <ul>
        <li><b>Windows:</b> click the <b>X</b> or press <b>Alt + F4</b></li>
        <li><b>Mac:</b> close the window or press <b>âŒ˜Q</b></li>
        <li><b>Mobile:</b> use Home gesture and close from the app switcher</li>
      </ul>
      <div class="rowBtns">
        <a class="btn" id="exitOkBtn" href="#">OK</a>
      </div>
    </div>
  </div>

  <script defer src="app.js"></script>
</body>
</html>
